<div class="dashboard-container fade-in">
  <!-- Header -->
  <div class="dashboard-header mb-4">
    <div>
      <h2 class="fw-bold">
        <i class="fas fa-tachometer-alt me-2"></i>Tableau de Bord - Chef de Département
      </h2>
      <p class="text-muted">Vue d'ensemble de {{ currentUser?.departement }}</p>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-success" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

  <div *ngIf="!loading">
    <!-- Stats Cards -->
    <div class="row g-4 mb-4">
      <div class="col-md-3">
        <div class="stat-card modern-card">
          <div class="stat-icon bg-primary">
            <i class="fas fa-folder"></i>
          </div>
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.documentsTotal }}</h3>
            <p class="stat-label">Documents Total</p>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <div class="stat-card modern-card">
          <div class="stat-icon bg-success">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.employesTotal }}</h3>
            <p class="stat-label">Employés</p>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <div class="stat-card modern-card">
          <div class="stat-icon bg-info">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.documentsThisMonth }}</h3>
            <p class="stat-label">Ce Mois</p>
          </div>
        </div>
      </div>

      <div class="col-md-3">
        <div class="stat-card modern-card">
          <div class="stat-icon bg-warning">
            <i class="fas fa-database"></i>
          </div>
          <div class="stat-info">
            <h3 class="stat-number">{{ formatBytes(stats.volumeStockage) }}</h3>
            <p class="stat-label">Stockage</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="row g-4 mb-4">
      <div class="col-md-12">
        <div class="modern-card p-4">
          <h4 class="mb-3 fw-bold">
            <i class="fas fa-bolt me-2"></i>Actions Rapides
          </h4>
          <div class="quick-actions">
            <button class="btn btn-outline-primary" routerLink="/chef/documents">
              <i class="fas fa-file-upload me-2"></i>Ajouter Document
            </button>
            <button class="btn btn-outline-success" routerLink="/chef/employes">
              <i class="fas fa-user-cog me-2"></i>Gérer Employés
            </button>
            <button class="btn btn-outline-info" routerLink="/chef/documents">
              <i class="fas fa-search me-2"></i>Rechercher Document
            </button>
            <button class="btn btn-outline-warning" routerLink="/chef/statistiques">
              <i class="fas fa-chart-line me-2"></i>Voir Statistiques
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Documents Récents et Top Employés -->
    <div class="row g-4">
      <!-- Documents Récents -->
      <div class="col-md-7">
        <div class="modern-card p-4">
          <h4 class="mb-3 fw-bold">
            <i class="fas fa-file-alt me-2"></i>Documents Récents
          </h4>
          <div class="documents-list">
            <div class="document-item" *ngFor="let doc of recentDocuments">
              <i class="fas fa-3x" [ngClass]="getFileIcon(doc.mime_type)"></i>
              <div class="document-content">
                <strong>{{ doc.titre }}</strong>
                <p class="text-muted mb-0">
                  <small>
                    <i class="fas fa-user me-1"></i>{{ doc.createur?.nom_complet }} -
                    <i class="fas fa-clock me-1"></i>{{ formatDate(doc.created_at) }}
                  </small>
                </p>
              </div>
              <button class="btn btn-sm btn-outline-primary" routerLink="/chef/documents">
                <i class="fas fa-eye"></i>
              </button>
            </div>

            <div *ngIf="recentDocuments.length === 0" class="text-center py-4">
              <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>
              <p class="text-muted">Aucun document récent</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Top Employés -->
      <div class="col-md-5">
        <div class="modern-card p-4">
          <h4 class="mb-3 fw-bold">
            <i class="fas fa-trophy me-2"></i>Top Employés Actifs
          </h4>
          <div class="employes-list">
            <div class="employe-item" *ngFor="let employe of topEmployes; let i = index">
              <div class="employe-rank" [class.gold]="i === 0" [class.silver]="i === 1" [class.bronze]="i === 2">
                {{ i + 1 }}
              </div>
              <div class="employe-avatar">
                <i class="fas fa-user-circle fa-2x text-success"></i>
              </div>
              <div class="employe-info">
                <strong>{{ employe.nom_complet }}</strong>
                <small class="text-muted">{{ employe.total_actions }} actions</small>
              </div>
            </div>

            <div *ngIf="topEmployes.length === 0" class="text-center py-4">
              <i class="fas fa-users fa-3x text-muted mb-3"></i>
              <p class="text-muted">Aucune activité</p>
            </div>
          </div>
          <div class="text-center mt-3">
            <button class="btn btn-sm btn-outline-success" routerLink="/chef/employes">
              Voir tous les employés
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
