<div class="notifications-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-left">
      <h2 class="page-title">
        <i class="fas fa-bell me-2"></i>
        Mes Notifications
      </h2>
      <p class="text-muted mb-0">Restez informé des mises à jour</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-outline-primary" (click)="loadNotifications(true)">
        <i class="fas fa-filter me-2"></i>
        {{ showUnreadOnly ? 'Toutes' : 'Non lues' }}
      </button>
      <button
        class="btn btn-primary"
        (click)="markAllAsRead()"
        [disabled]="unreadCount === 0"
      >
        <i class="fas fa-check-double me-2"></i>
        Tout marquer comme lu
      </button>
    </div>
  </div>

  <!-- Stats -->
  <div class="row g-3 mb-4">
    <div class="col-md-4">
      <div class="stat-card">
        <div class="stat-icon bg-primary">
          <i class="fas fa-inbox"></i>
        </div>
        <div class="stat-info">
          <h4>{{ totalNotifications }}</h4>
          <p>Total</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stat-card">
        <div class="stat-icon bg-danger">
          <i class="fas fa-envelope"></i>
        </div>
        <div class="stat-info">
          <h4>{{ unreadCount }}</h4>
          <p>Non lues</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stat-card">
        <div class="stat-icon bg-success">
          <i class="fas fa-envelope-open"></i>
        </div>
        <div class="stat-info">
          <h4>{{ totalNotifications - unreadCount }}</h4>
          <p>Lues</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
    <p class="mt-3 text-muted">Chargement des notifications...</p>
  </div>

  <!-- Liste des notifications -->
  <div *ngIf="!loading" class="notifications-list">
    <!-- Aucune notification -->
    <div *ngIf="notifications.length === 0" class="empty-state">
      <i class="fas fa-bell-slash fa-3x text-muted mb-3"></i>
      <h5>Aucune notification</h5>
      <p class="text-muted">Vous n'avez pas de notifications pour le moment</p>
    </div>

    <!-- Notifications -->
    <div
      *ngFor="let notif of notifications"
      class="notification-card"
      [class.unread]="notif.statut === 'non_lu'"
      (click)="markAsRead(notif)"
    >
      <div class="notif-icon" [ngClass]="getNotificationClass(notif.type_notification)">
        <i [class]="getNotificationIcon(notif.type_notification)"></i>
      </div>

      <div class="notif-content">
        <div class="notif-header">
          <h6 class="notif-title">{{ notif.titre }}</h6>
          <span class="notif-time">{{ formatTime(notif.created_at) }}</span>
        </div>
        <p class="notif-message">{{ notif.message }}</p>
        <div class="notif-footer" *ngIf="notif.document">
          <span class="document-badge">
            <i class="fas fa-file-alt me-1"></i>
            {{ notif.document.titre }}
          </span>
        </div>
      </div>

      <div class="notif-actions">
        <span class="status-badge" *ngIf="notif.statut === 'non_lu'">Nouveau</span>
        <button
          class="btn btn-sm btn-outline-danger"
          (click)="deleteNotification(notif.id, $event)"
          title="Supprimer"
        >
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <button
        class="btn btn-outline-primary"
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)"
      >
        <i class="fas fa-chevron-left"></i>
      </button>

      <span class="pagination-info">
        Page {{ currentPage }} sur {{ totalPages }}
      </span>

      <button
        class="btn btn-outline-primary"
        [disabled]="currentPage === totalPages"
        (click)="changePage(currentPage + 1)"
      >
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
</div>
